---
import { Image } from "astro:assets";
import BoardImg from "@/assets/images/board_img.png";
import MasterMatilda from "@/assets/images/master_matilda.png";
---

<section class="problem-statement-section my-8 pb-32 lg:pb-8">
    <h2 class="text-4xl font-bold text-center mb-8">Problem Statements</h2>
    
    <div class="relative w-full max-w-6xl mx-auto">


        <!-- Problem Statement Display Area -->
        <div class="flex flex-col lg:flex-row justify-center items-end">
            <!-- Master Matilda Character -->
            <div class="flex-shrink-0 hidden lg:block relative z-10">
                <Image
                    src={MasterMatilda}
                    alt="Master Matilda"
                    class="w-[30rem] h-auto xl:w-[36rem] 2xl:w-[42rem]"
                />
            </div>

            <!-- Board with Problem Statements -->
            <div class="relative flex-shrink-0 lg:-ml-32 xl:-ml-40 2xl:-ml-48">
                <Image
                    src={BoardImg}
                    alt="Problem Statement Board"
                    class="w-full max-w-2xl xl:max-w-3xl h-auto"
                />
                
                <!-- Master Matilda for Mobile - positioned on left side with overlap -->
                <div class="absolute -bottom-48 -left-4 lg:hidden z-10">
                    <Image
                        src={MasterMatilda}
                        alt="Master Matilda"
                        class="w-96 h-auto sm:w-[28rem]"
                    />
                </div>

            </div>
        </div>
    </div>
</section>

<style>
    .toggle-btn {
        background: transparent;
        color: #9ca3af;
        border: none;
        cursor: pointer;
    }
    
    .toggle-btn.active {
        background: #3b82f6;
        color: white;
    }
    
    .statement-item {
        opacity: 0.6;
        transform: scale(0.95);
        transition: all 0.3s ease;
        background: transparent;
        border-radius: 0;
        box-shadow: none;
    }
    
    .statement-item.active {
        opacity: 1;
        transform: scale(1);
    }
    
    .problem-content {
        max-height: 400px;
        overflow-y: auto;
    }
    
    /* Custom scrollbar for problem content */
    .problem-content::-webkit-scrollbar {
        width: 6px;
    }
    
    .problem-content::-webkit-scrollbar-track {
        background: rgba(139, 69, 19, 0.2);
        border-radius: 3px;
    }
    
    .problem-content::-webkit-scrollbar-thumb {
        background: rgba(139, 69, 19, 0.6);
        border-radius: 3px;
    }
    
    .problem-content::-webkit-scrollbar-thumb:hover {
        background: rgba(139, 69, 19, 0.8);
    }
</style>

<script>
    function initProblemStatements() {
        const currentBtn = document.getElementById('current-btn');
        const pastBtn = document.getElementById('past-btn');
        const currentStatements = document.getElementById('current-statements');
        const pastStatements = document.getElementById('past-statements');
        
        if (!currentBtn || !pastBtn || !currentStatements || !pastStatements) return;
        
        // Toggle functionality
        currentBtn.addEventListener('click', () => {
            currentBtn.classList.add('active');
            pastBtn.classList.remove('active');
            currentStatements.classList.remove('hidden');
            pastStatements.classList.add('hidden');
        });
        
        pastBtn.addEventListener('click', () => {
            pastBtn.classList.add('active');
            currentBtn.classList.remove('active');
            pastStatements.classList.remove('hidden');
            currentStatements.classList.add('hidden');
        });
        
        // Auto-rotate through statements
        function rotateStatements() {
            const activeGroup = document.querySelector('.statement-group:not(.hidden)');
            if (!activeGroup) return;
            
            const statements = activeGroup.querySelectorAll('.statement-item');
            const currentActive = activeGroup.querySelector('.statement-item.active');
            
            if (statements.length === 0) return;
            
            let currentIndex = Array.from(statements).indexOf(currentActive);
            
            // Remove active class from current
            if (currentActive) {
                currentActive.classList.remove('active');
            }
            
            // Move to next statement
            currentIndex = (currentIndex + 1) % statements.length;
            statements[currentIndex].classList.add('active');
        }
        
        // Start auto-rotation
        setInterval(rotateStatements, 4000);
    }
    
    // Initialize on DOM ready
    document.addEventListener('DOMContentLoaded', initProblemStatements);
    
    // Re-initialize on Astro page transitions
    document.addEventListener('astro:page-load', initProblemStatements);
    
    // Also handle the case where script runs after DOM is already loaded
    if (document.readyState !== 'loading') {
        initProblemStatements();
    }
</script>